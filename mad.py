# this model decides how your total investment should be portioned amoung different stocks to create a portfolio that is expected to acheive a minimum profit margin at minimal risk
# risk is defined by how much a stocks return moves above/below its expected return over time (ie. volitility)

# ---- setup the model ----

from pyomo.environ import *    # imports the pyomo environment
from pyomo.opt import SolverFactory    # imports the solver environment
from pyomo.core import Var    # imports the variable environment
import gc    # imports the garbage collection environment

model = AbstractModel()    # creates an abstract model
model.name = "Portfolio Selection LP"    # gives the model a name

# ---- define set(s) ----

model.time = Set()    # a set of time periods
model.stocks = Set()    # a set of stocks

# ---- define parameter(s) ----

model.diffLog = Param(model.stocks, model.time, initialize = 0, mutable = True)    # the observed value of diff(log('price')) for a stock at a time period (ie. observed log return)
model.meanDiffLog = Param(model.stocks, mutable = True)    # the expected value of diff(log('price')) for a stock during the current horizon (ie. expected log return)
model.logMarginPlusOne = Param()    # the log('minimum profit margin' + 1)

# ---- define variable(s) ----

model.portion = Var(model.stocks, domain = NonNegativeReals)    # the portion of your total investment put in a stock
model.risk = Var(model.time, domain = NonNegativeReals)    # the total amount of risk during a time period --> risk = how much every invested stock varies about their expected return (ie. volitility)

# ---- define objective function(s) ----

def obj(model):
    return sum(model.risk[t] for t in model.time)   # the total amount of risk during a horizon (ie. portfolio volitility)

model.obj = Objective(rule = obj, sense = minimize)    # a minimization problem of the function defined above

# ---- define constraint(s) ----

def NEGDEVIATION(model, t):
    return model.risk[t] >= sum((model.meanDiffLog[s] - model.diffLog[s,t]) * model.portion[s] for s in model.stocks)    # risk is how much the observed log return is less than the expected log return across all stocks

def POSDEVIATION(model, t):
    return model.risk[t] >= sum((model.diffLog[s,t] - model.meanDiffLog[s]) * model.portion[s] for s in model.stocks)    # risk is how much the observed log return is greater than the expected log return across all stocks

def PROFIT(model, s):
    return model.portion[s] * (sum(model.diffLog[s,t] for t in model.time) - model.logMarginPlusOne) >= 0    # the realized rate of return for each stock must satisfy the minimum rate of return

def INVEST(model):
    return sum(model.portion[s] for s in model.stocks) == 1    # use up the entire investment

model.st_NEGDEVIATION = Constraint(model.time, rule = NEGDEVIATION)    # apply the NEGDEVIATION constraint across all time periods
model.st_POSDEVIATION = Constraint(model.time, rule = POSDEVIATION)    # apply the POSDEVIATION constraint across all time periods
model.st_PROFIT = Constraint(model.stocks, rule = PROFIT)    # apply the PROFIT constraint across all stocks
model.st_INVEST = Constraint(rule = INVEST)    # apply the INVEST constraint

# ---- execute solver ----

opt = SolverFactory("glpk")    # call the glpk solver
# opt = SolverFactory("ipopt", solver_io = "nl")    # call the ipopt solver

# create a list of the dat file names
datfiles = ['mad-yahoo-2009-10.dat','mad-yahoo-2010-10.dat','mad-yahoo-2011-10.dat','mad-yahoo-2012-10.dat','mad-yahoo-2013-10.dat','mad-yahoo-2014-10.dat','mad-yahoo-2015-10.dat','mad-yahoo-2016-10.dat','mad-yahoo-2017-10.dat','mad-yahoo-2009-15.dat','mad-yahoo-2010-15.dat','mad-yahoo-2011-15.dat','mad-yahoo-2012-15.dat','mad-yahoo-2013-15.dat','mad-yahoo-2014-15.dat','mad-yahoo-2015-15.dat','mad-yahoo-2016-15.dat','mad-yahoo-2017-15.dat','mad-yahoo-2009-20.dat','mad-yahoo-2010-20.dat','mad-yahoo-2011-20.dat','mad-yahoo-2012-20.dat','mad-yahoo-2013-20.dat','mad-yahoo-2014-20.dat','mad-yahoo-2015-20.dat','mad-yahoo-2016-20.dat','mad-yahoo-2017-20.dat','mad-yahoo-2009-25.dat','mad-yahoo-2010-25.dat','mad-yahoo-2011-25.dat','mad-yahoo-2012-25.dat','mad-yahoo-2013-25.dat','mad-yahoo-2014-25.dat','mad-yahoo-2015-25.dat','mad-yahoo-2016-25.dat','mad-yahoo-2017-25.dat','mad-yahoo-2009-30.dat','mad-yahoo-2010-30.dat','mad-yahoo-2011-30.dat','mad-yahoo-2012-30.dat','mad-yahoo-2013-30.dat','mad-yahoo-2014-30.dat','mad-yahoo-2015-30.dat','mad-yahoo-2016-30.dat','mad-yahoo-2017-30.dat','mad-yahoo-2009-35.dat','mad-yahoo-2010-35.dat','mad-yahoo-2011-35.dat','mad-yahoo-2012-35.dat','mad-yahoo-2013-35.dat','mad-yahoo-2014-35.dat','mad-yahoo-2015-35.dat','mad-yahoo-2016-35.dat','mad-yahoo-2017-35.dat','mad-yahoo-2009-40.dat','mad-yahoo-2010-40.dat','mad-yahoo-2011-40.dat','mad-yahoo-2012-40.dat','mad-yahoo-2013-40.dat','mad-yahoo-2014-40.dat','mad-yahoo-2015-40.dat','mad-yahoo-2016-40.dat','mad-yahoo-2017-40.dat','mad-yahoo-2009-45.dat','mad-yahoo-2010-45.dat','mad-yahoo-2011-45.dat','mad-yahoo-2012-45.dat','mad-yahoo-2013-45.dat','mad-yahoo-2014-45.dat','mad-yahoo-2015-45.dat','mad-yahoo-2016-45.dat','mad-yahoo-2017-45.dat','mad-yahoo-2009-50.dat','mad-yahoo-2010-50.dat','mad-yahoo-2011-50.dat','mad-yahoo-2012-50.dat','mad-yahoo-2013-50.dat','mad-yahoo-2014-50.dat','mad-yahoo-2015-50.dat','mad-yahoo-2016-50.dat','mad-yahoo-2017-50.dat','mad-yahoo-2009-55.dat','mad-yahoo-2010-55.dat','mad-yahoo-2011-55.dat','mad-yahoo-2012-55.dat','mad-yahoo-2013-55.dat','mad-yahoo-2014-55.dat','mad-yahoo-2015-55.dat','mad-yahoo-2016-55.dat','mad-yahoo-2017-55.dat','mad-yahoo-2009-60.dat','mad-yahoo-2010-60.dat','mad-yahoo-2011-60.dat','mad-yahoo-2012-60.dat','mad-yahoo-2013-60.dat','mad-yahoo-2014-60.dat','mad-yahoo-2015-60.dat','mad-yahoo-2016-60.dat','mad-yahoo-2017-60.dat','mad-yahoo-2009-65.dat','mad-yahoo-2010-65.dat','mad-yahoo-2011-65.dat','mad-yahoo-2012-65.dat','mad-yahoo-2013-65.dat','mad-yahoo-2014-65.dat','mad-yahoo-2015-65.dat','mad-yahoo-2016-65.dat','mad-yahoo-2017-65.dat','mad-yahoo-2009-70.dat','mad-yahoo-2010-70.dat','mad-yahoo-2011-70.dat','mad-yahoo-2012-70.dat','mad-yahoo-2013-70.dat','mad-yahoo-2014-70.dat','mad-yahoo-2015-70.dat','mad-yahoo-2016-70.dat','mad-yahoo-2017-70.dat','mad-yahoo-2009-75.dat','mad-yahoo-2010-75.dat','mad-yahoo-2011-75.dat','mad-yahoo-2012-75.dat','mad-yahoo-2013-75.dat','mad-yahoo-2014-75.dat','mad-yahoo-2015-75.dat','mad-yahoo-2016-75.dat','mad-yahoo-2017-75.dat','mad-yahoo-2009-80.dat','mad-yahoo-2010-80.dat','mad-yahoo-2011-80.dat','mad-yahoo-2012-80.dat','mad-yahoo-2013-80.dat','mad-yahoo-2014-80.dat','mad-yahoo-2015-80.dat','mad-yahoo-2016-80.dat','mad-yahoo-2017-80.dat','mad-yahoo-2009-85.dat','mad-yahoo-2010-85.dat','mad-yahoo-2011-85.dat','mad-yahoo-2012-85.dat','mad-yahoo-2013-85.dat','mad-yahoo-2014-85.dat','mad-yahoo-2015-85.dat','mad-yahoo-2016-85.dat','mad-yahoo-2017-85.dat','mad-yahoo-2009-90.dat','mad-yahoo-2010-90.dat','mad-yahoo-2011-90.dat','mad-yahoo-2012-90.dat','mad-yahoo-2013-90.dat','mad-yahoo-2014-90.dat','mad-yahoo-2015-90.dat','mad-yahoo-2016-90.dat','mad-yahoo-2017-90.dat','mad-yahoo-2009-95.dat','mad-yahoo-2010-95.dat','mad-yahoo-2011-95.dat','mad-yahoo-2012-95.dat','mad-yahoo-2013-95.dat','mad-yahoo-2014-95.dat','mad-yahoo-2015-95.dat','mad-yahoo-2016-95.dat','mad-yahoo-2017-95.dat','mad-yahoo-2009-100.dat','mad-yahoo-2010-100.dat','mad-yahoo-2011-100.dat','mad-yahoo-2012-100.dat','mad-yahoo-2013-100.dat','mad-yahoo-2014-100.dat','mad-yahoo-2015-100.dat','mad-yahoo-2016-100.dat','mad-yahoo-2017-100.dat']

# create a list of result files names (include the path)
resultfiles = ['C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-10-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-10-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-10-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-10-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-10-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-10-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-10-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-10-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-10-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-15-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-15-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-15-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-15-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-15-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-15-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-15-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-15-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-15-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-20-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-20-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-20-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-20-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-20-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-20-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-20-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-20-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-20-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-25-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-25-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-25-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-25-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-25-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-25-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-25-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-25-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-25-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-30-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-30-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-30-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-30-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-30-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-30-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-30-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-30-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-30-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-35-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-35-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-35-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-35-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-35-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-35-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-35-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-35-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-35-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-40-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-40-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-40-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-40-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-40-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-40-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-40-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-40-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-40-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-45-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-45-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-45-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-45-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-45-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-45-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-45-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-45-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-45-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-50-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-50-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-50-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-50-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-50-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-50-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-50-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-50-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-50-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-55-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-55-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-55-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-55-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-55-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-55-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-55-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-55-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-55-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-60-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-60-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-60-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-60-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-60-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-60-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-60-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-60-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-60-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-65-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-65-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-65-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-65-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-65-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-65-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-65-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-65-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-65-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-70-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-70-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-70-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-70-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-70-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-70-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-70-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-70-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-70-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-75-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-75-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-75-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-75-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-75-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-75-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-75-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-75-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-75-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-80-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-80-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-80-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-80-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-80-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-80-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-80-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-80-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-80-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-85-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-85-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-85-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-85-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-85-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-85-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-85-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-85-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-85-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-90-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-90-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-90-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-90-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-90-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-90-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-90-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-90-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-90-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-95-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-95-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-95-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-95-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-95-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-95-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-95-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-95-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-95-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2009-100-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2010-100-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2011-100-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2012-100-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2013-100-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2014-100-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2015-100-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2016-100-results.txt','C:/Users/Nick Morris/Downloads/Data-Science/Projects/Stock-Market-Portfolio-Optimization/Models/Portfolio/mad-yahoo-2017-100-results.txt']

# manually define a file number if you like (starts at 0)
# filenum = 0

# define a start number (starts at 0)
startnum = 0

# solve every dat file (ie. problem instance)
for filenum in range(startnum, len(datfiles)):
	instance = []    # reset the problem instance
	results = []    # reset the solution
	varobject = []    # reset the variable values
	gc.collect()    # collect the garbage from the problem instance, solution, and variable values
	
	instance = model.create_instance(datfiles[filenum])    # create a problem instance
	results = opt.solve(instance, tee = True)    # solve the problem instance
	results.write()    # print out the solution to the console
	instance.solutions.load_from(results)    # store the solution results
	
	# open the path to where the results will be written
	with open(resultfiles[filenum], "w") as myfile:
		
		# write out the value of the objective function
		# myfile.write ("{}, {}\n".format("objective", value(instance.obj)))
		
		# get the value of each variable
		for v in instance.component_objects(Var, active = True):
			varobject = getattr(instance, str(v))
			
			# write out the value of each variable
			for index in varobject:
				myfile.write ("{}, {}, {}\n".format(v, index, varobject[index].value))
